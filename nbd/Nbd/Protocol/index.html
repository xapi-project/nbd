<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Protocol (nbd.Nbd.Protocol)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">nbd</a> &#x00BB; <a href="../index.html">Nbd</a> &#x00BB; Protocol</nav><header class="odoc-preamble"><h1>Module <code><span>Nbd.Protocol</span></code></h1><p>Types representing NBD protocol requests and responses.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-Error" class="anchored"><a href="#module-Error" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Error/index.html">Error</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Read and write requests can fail with an error response.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Command" class="anchored"><a href="#module-Command" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Command/index.html">Command</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Once a connection has been established, the client can submit commands.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-PerExportFlag" class="anchored"><a href="#module-PerExportFlag" class="anchor"></a><code><span><span class="keyword">module</span> <a href="PerExportFlag/index.html">PerExportFlag</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Every disk (or 'export') has a number of associated flags. This will be returned from the server when the negotiation is complete.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-GlobalFlag" class="anchored"><a href="#module-GlobalFlag" class="anchor"></a><code><span><span class="keyword">module</span> <a href="GlobalFlag/index.html">GlobalFlag</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>During the protocol negotiation there are some defined flags used to choose protocol variants. These flags are sent by the server.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-ClientFlag" class="anchored"><a href="#module-ClientFlag" class="anchor"></a><code><span><span class="keyword">module</span> <a href="ClientFlag/index.html">ClientFlag</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>During the protocol negotiation there are some defined flags used to choose protocol variants. These flags are sent by the client.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Option" class="anchored"><a href="#module-Option" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Option/index.html">Option</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>In the 'newstyle' negotiation there is an opportunity for the client to negotiate options with the server. These are the known options.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-OptionResponse" class="anchored"><a href="#module-OptionResponse" class="anchor"></a><code><span><span class="keyword">module</span> <a href="OptionResponse/index.html">OptionResponse</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>When the client sends an option request, the server must reply.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Announcement" class="anchored"><a href="#module-Announcement" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Announcement/index.html">Announcement</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The server sends an initial greeting when the connectino is opened. It can be of two main types: the original <code>V1</code> and a 'newstyle' <code>V2</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Negotiate" class="anchored"><a href="#module-Negotiate" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Negotiate/index.html">Negotiate</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The initial greeting sent by the server</p></div></div><div class="odoc-spec"><div class="spec module" id="module-NegotiateResponse" class="anchored"><a href="#module-NegotiateResponse" class="anchor"></a><code><span><span class="keyword">module</span> <a href="NegotiateResponse/index.html">NegotiateResponse</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The client's initial response to the server's greeting</p></div></div><div class="odoc-spec"><div class="spec module" id="module-OptionRequestHeader" class="anchored"><a href="#module-OptionRequestHeader" class="anchor"></a><code><span><span class="keyword">module</span> <a href="OptionRequestHeader/index.html">OptionRequestHeader</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Every option the client requests has the same header.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-ExportName" class="anchored"><a href="#module-ExportName" class="anchor"></a><code><span><span class="keyword">module</span> <a href="ExportName/index.html">ExportName</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>An ExportName option payload</p></div></div><div class="odoc-spec"><div class="spec module" id="module-DiskInfo" class="anchored"><a href="#module-DiskInfo" class="anchor"></a><code><span><span class="keyword">module</span> <a href="DiskInfo/index.html">DiskInfo</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Details about the export chosen by the client, sent in response to an <code>ExportName</code> option.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-OptionResponseHeader" class="anchored"><a href="#module-OptionResponseHeader" class="anchor"></a><code><span><span class="keyword">module</span> <a href="OptionResponseHeader/index.html">OptionResponseHeader</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The server sends a response to every option request sent by the client (except <code>ExportName</code> which is followed by a <code>DiskInfo</code>. This is the header of the response.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Server" class="anchored"><a href="#module-Server" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Server/index.html">Server</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>In response to a <code>List</code> option, the server sends a number of <code>Server</code> responses and then finally an <code>Ack</code></p></div></div><div class="odoc-spec"><div class="spec module" id="module-Request" class="anchored"><a href="#module-Request" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Request/index.html">Request</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>After the negotation phase, clients send I/O requests to the server.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Reply" class="anchored"><a href="#module-Reply" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Reply/index.html">Reply</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A reply sent from the server in response to a <code>Request</code>. Note these arrive out-of-order.</p></div></div></div></body></html>